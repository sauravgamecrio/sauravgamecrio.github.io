/*!
 * @pixi/compressed-textures - v6.0.2
 * Compiled Mon, 05 Apr 2021 18:17:46 UTC
 *
 * @pixi/compressed-textures is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{ViewableBuffer as t,BufferResource as e,Texture as _,BaseTexture as r}from"@pixi/core";import{LoaderResource as n}from"@pixi/loaders";import{BLEND_MODES as o,MIPMAP_MODES as s,ALPHA_MODES as a,TYPES as i,FORMATS as R}from"@pixi/constants";var T,h;!function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL"}(h||(h={}));var E=((T={})[h.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,T[h.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,T[h.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,T[h.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,T[h.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,T[h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,T[h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,T[h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,T[h.COMPRESSED_R11_EAC]=.5,T[h.COMPRESSED_SIGNED_R11_EAC]=.5,T[h.COMPRESSED_RG11_EAC]=1,T[h.COMPRESSED_SIGNED_RG11_EAC]=1,T[h.COMPRESSED_RGB8_ETC2]=.5,T[h.COMPRESSED_RGBA8_ETC2_EAC]=1,T[h.COMPRESSED_SRGB8_ETC2]=.5,T[h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,T[h.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,T[h.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,T[h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,T[h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,T[h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,T[h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,T[h.COMPRESSED_RGB_ETC1_WEBGL]=.5,T[h.COMPRESSED_RGB_ATC_WEBGL]=.5,T[h.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,T[h.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,T),O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var _ in e)e.hasOwnProperty(_)&&(t[_]=e[_])})(t,e)};function A(t,e){function _(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(_.prototype=e.prototype,new _)}function u(t,e){var _,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(_)throw new TypeError("Generator is already executing.");for(;s;)try{if(_=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{_=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var G=function(e){function _(_,r){void 0===r&&(r={width:1,height:1,autoLoad:!0});var n,o,s=this;return"string"==typeof _?(n=_,o=new Uint8Array):(n=null,o=_),(s=e.call(this,o,r)||this).origin=n,s.buffer=o?new t(o):null,s.origin&&!1!==r.autoLoad&&s.load(),o&&o.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s}return A(_,e),_.prototype.onBlobLoaded=function(t){},_.prototype.load=function(){return e=this,_=void 0,r=Promise,n=function(){var e;return u(this,function(_){switch(_.label){case 0:return[4,fetch(this.origin)];case 1:return[4,_.sent().blob()];case 2:return[4,_.sent().arrayBuffer()];case 3:return e=_.sent(),this.data=new Uint32Array(e),this.buffer=new t(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),[2,this]}})},new(r||(r=Promise))(function(t,o){function s(t){try{i(n.next(t))}catch(t){o(t)}}function a(t){try{i(n.throw(t))}catch(t){o(t)}}function i(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(s,a)}i((n=n.apply(e,_||[])).next())});var e,_,r,n},_}(e),M=function(t){function e(_,r){var n=t.call(this,_,r)||this;return n.format=r.format,n.levels=r.levels||1,n._width=r.width,n._height=r.height,n._extension=e._formatToExtension(n.format),(r.levelBuffers||n.buffer)&&(n._levelBuffers=r.levelBuffers||e._createLevelBuffers(_ instanceof Uint8Array?_:n.buffer.uint8View,n.format,n.levels,4,4,n.width,n.height)),n}return A(e,t),e.prototype.upload=function(t,e,_){var r=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var n=0,o=this.levels;n<o;n++){var s=this._levelBuffers[n],a=s.levelID,i=s.levelWidth,R=s.levelHeight,T=s.levelBuffer;r.compressedTexImage2D(r.TEXTURE_2D,a,this.format,i,R,0,T)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,_,r,n,o,s){for(var a=new Array(_),i=t.byteOffset,R=o,T=s,h=R+r-1&~(r-1),O=T+n-1&~(n-1),A=h*O*E[e],u=0;u<_;u++)a[u]={levelID:u,levelWidth:_>1?R:h,levelHeight:_>1?T:O,levelBuffer:new Uint8Array(t.buffer,i,A)},i+=A,A=(h=(R=R>>1||1)+r-1&~(r-1))*(O=(T=T>>1||1)+n-1&~(n-1))*E[e];return a},e}(G),S=/iPhone/i,c=/iPod/i,D=/iPad/i,l=/\biOS-universal(?:.+)Mac\b/i,f=/\bAndroid(?:.+)Mobile\b/i,I=/Android/i,p=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,X=/Silk/i,C=/Windows Phone/i,F=/\bWindows(?:.+)ARM\b/i,P=/BlackBerry/i,B=/BB10/i,v=/Opera Mini/i,d=/\b(CriOS|Chrome)(?:.+)Mobile/i,N=/Mobile(?:.+)Firefox\b/i,m=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var U=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var _=e.userAgent,r=_.split("[FBAN");void 0!==r[1]&&(_=r[0]),void 0!==(r=_.split("Twitter"))[1]&&(_=r[0]);var n=function(t){return function(e){return e.test(t)}}(_),o={apple:{phone:n(S)&&!n(C),ipod:n(c),tablet:!n(S)&&(n(D)||m(e))&&!n(C),universal:n(l),device:(n(S)||n(c)||n(D)||n(l)||m(e))&&!n(C)},amazon:{phone:n(p),tablet:!n(p)&&n(X),device:n(p)||n(X)},android:{phone:!n(C)&&n(p)||!n(C)&&n(f),tablet:!n(C)&&!n(p)&&!n(f)&&(n(X)||n(I)),device:!n(C)&&(n(p)||n(X)||n(f)||n(I))||n(/\bokhttp\b/i)},windows:{phone:n(C),tablet:n(F),device:n(C)||n(F)},other:{blackberry:n(P),blackberry10:n(B),opera:n(v),firefox:n(N),chrome:n(d),device:n(P)||n(B)||n(v)||n(N)||n(d)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(self.navigator);var L={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(U.tablet||U.phone){var _;U.apple.device&&(_=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(_[1],10)<11&&(e=!1),U.android.device&&(_=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(_[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:U.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!U.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function y(t,e,_){return t(_={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&_.path)}},_.exports),_.exports}y(function(t){var e=Object.prototype.hasOwnProperty,_="~";function r(){}function n(t,e,_){this.fn=t,this.context=e,this.once=_||!1}function o(t,e,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new n(r,o||t,s),i=_?_+e:e;return t._events[i]?t._events[i].fn?t._events[i]=[t._events[i],a]:t._events[i].push(a):(t._events[i]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(_=!1)),a.prototype.eventNames=function(){var t,r,n=[];if(0===this._eventsCount)return n;for(r in t=this._events)e.call(t,r)&&n.push(_?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},a.prototype.listeners=function(t){var e=_?_+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,s=new Array(o);n<o;n++)s[n]=r[n].fn;return s},a.prototype.listenerCount=function(t){var e=_?_+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,n,o,s){var a=arguments,i=_?_+t:t;if(!this._events[i])return!1;var R,T,h=this._events[i],E=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),E){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,n),!0;case 5:return h.fn.call(h.context,e,r,n,o),!0;case 6:return h.fn.call(h.context,e,r,n,o,s),!0}for(T=1,R=new Array(E-1);T<E;T++)R[T-1]=a[T];h.fn.apply(h.context,R)}else{var O,A=h.length;for(T=0;T<A;T++)switch(h[T].once&&this.removeListener(t,h[T].fn,void 0,!0),E){case 1:h[T].fn.call(h[T].context);break;case 2:h[T].fn.call(h[T].context,e);break;case 3:h[T].fn.call(h[T].context,e,r);break;case 4:h[T].fn.call(h[T].context,e,r,n);break;default:if(!R)for(O=1,R=new Array(E-1);O<E;O++)R[O-1]=a[O];h[T].fn.apply(h[T].context,R)}}return!0},a.prototype.on=function(t,e,_){return o(this,t,e,_,!1)},a.prototype.once=function(t,e,_){return o(this,t,e,_,!0)},a.prototype.removeListener=function(t,e,r,n){var o=_?_+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||s(this,o);else{for(var i=0,R=[],T=a.length;i<T;i++)(a[i].fn!==e||n&&!a[i].once||r&&a[i].context!==r)&&R.push(a[i]);R.length?this._events[o]=1===R.length?R[0]:R:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=_?_+t:t,this._events[e]&&s(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=_,a.EventEmitter=a,t.exports=a});var w=y(function(t,e){!function(_){var r=e&&!e.nodeType&&e,n=t&&!t.nodeType&&t,o="object"==typeof g&&g;o.global!==o&&o.window!==o&&o.self!==o||(_=o);var s,a,i=2147483647,R=36,T=1,h=26,E=38,O=700,A=72,u=128,G="-",M=/^xn--/,S=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},l=R-T,f=Math.floor,I=String.fromCharCode;function p(t){throw RangeError(D[t])}function X(t,e){for(var _=t.length,r=[];_--;)r[_]=e(t[_]);return r}function C(t,e){var _=t.split("@"),r="";return _.length>1&&(r=_[0]+"@",t=_[1]),r+X((t=t.replace(c,".")).split("."),e).join(".")}function F(t){for(var e,_,r=[],n=0,o=t.length;n<o;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<o?56320==(64512&(_=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&_)+65536):(r.push(e),n--):r.push(e);return r}function P(t){return X(t,function(t){var e="";return t>65535&&(e+=I((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=I(t)}).join("")}function B(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function v(t,e,_){var r=0;for(t=_?f(t/O):t>>1,t+=f(t/e);t>l*h>>1;r+=R)t=f(t/l);return f(r+(l+1)*t/(t+E))}function d(t){var e,_,r,n,o,s,a,E,O,M,S,c=[],D=t.length,l=0,I=u,X=A;for((_=t.lastIndexOf(G))<0&&(_=0),r=0;r<_;++r)t.charCodeAt(r)>=128&&p("not-basic"),c.push(t.charCodeAt(r));for(n=_>0?_+1:0;n<D;){for(o=l,s=1,a=R;n>=D&&p("invalid-input"),((E=(S=t.charCodeAt(n++))-48<10?S-22:S-65<26?S-65:S-97<26?S-97:R)>=R||E>f((i-l)/s))&&p("overflow"),l+=E*s,!(E<(O=a<=X?T:a>=X+h?h:a-X));a+=R)s>f(i/(M=R-O))&&p("overflow"),s*=M;X=v(l-o,e=c.length+1,0==o),f(l/e)>i-I&&p("overflow"),I+=f(l/e),l%=e,c.splice(l++,0,I)}return P(c)}function N(t){var e,_,r,n,o,s,a,E,O,M,S,c,D,l,X,C=[];for(c=(t=F(t)).length,e=u,_=0,o=A,s=0;s<c;++s)(S=t[s])<128&&C.push(I(S));for(r=n=C.length,n&&C.push(G);r<c;){for(a=i,s=0;s<c;++s)(S=t[s])>=e&&S<a&&(a=S);for(a-e>f((i-_)/(D=r+1))&&p("overflow"),_+=(a-e)*D,e=a,s=0;s<c;++s)if((S=t[s])<e&&++_>i&&p("overflow"),S==e){for(E=_,O=R;!(E<(M=O<=o?T:O>=o+h?h:O-o));O+=R)X=E-M,l=R-M,C.push(I(B(M+X%l,0))),E=f(X/l);C.push(I(B(E,0))),o=v(_,D,r==n),_=0,++r}++_,++e}return C.join("")}if(s={version:"1.3.2",ucs2:{decode:F,encode:P},decode:d,encode:N,toASCII:function(t){return C(t,function(t){return S.test(t)?"xn--"+N(t):t})},toUnicode:function(t){return C(t,function(t){return M.test(t)?d(t.slice(4).toLowerCase()):t})}},r&&n)if(t.exports==r)n.exports=s;else for(a in s)s.hasOwnProperty(a)&&(r[a]=s[a]);else _.punycode=s}(g)}),b={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}};function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Y=function(t,e,_,r){e=e||"&",_=_||"=";var n={};if("string"!=typeof t||0===t.length)return n;var o=/\+/g;t=t.split(e);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var i=0;i<a;++i){var R,T,h,E,O=t[i].replace(o,"%20"),A=O.indexOf(_);A>=0?(R=O.substr(0,A),T=O.substr(A+1)):(R=O,T=""),h=decodeURIComponent(R),E=decodeURIComponent(T),x(n,h)?Array.isArray(n[h])?n[h].push(E):n[h]=[n[h],E]:n[h]=E}return n},H=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},j=function(t,e,_,r){return e=e||"&",_=_||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(r){var n=encodeURIComponent(H(r))+_;return Array.isArray(t[r])?t[r].map(function(t){return n+encodeURIComponent(H(t))}).join(e):n+encodeURIComponent(H(t[r]))}).join(e):r?encodeURIComponent(H(r))+_+encodeURIComponent(H(t)):""},V=y(function(t,e){e.decode=e.parse=Y,e.encode=e.stringify=j}),W=at,k=function(t,e){return at(t,!1,!0).resolve(e)},q=function(t){b.isString(t)&&(t=at(t));if(!(t instanceof K))return K.prototype.format.call(t);return t.format()};function K(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var z=/^([a-z0-9.+-]+:)/i,Q=/:[0-9]*$/,$=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Z=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),J=["'"].concat(Z),tt=["%","/","?",";","#"].concat(J),et=["/","?","#"],_t=/^[+a-z0-9A-Z_-]{0,63}$/,rt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,nt={javascript:!0,"javascript:":!0},ot={javascript:!0,"javascript:":!0},st={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function at(t,e,_){if(t&&b.isObject(t)&&t instanceof K)return t;var r=new K;return r.parse(t,e,_),r}K.prototype.parse=function(t,e,_){if(!b.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),n=-1!==r&&r<t.indexOf("#")?"?":"#",o=t.split(n);o[0]=o[0].replace(/\\/g,"/");var s=t=o.join(n);if(s=s.trim(),!_&&1===t.split("#").length){var a=$.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=e?V.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var i=z.exec(s);if(i){var R=(i=i[0]).toLowerCase();this.protocol=R,s=s.substr(i.length)}if(_||i||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===s.substr(0,2);!T||i&&ot[i]||(s=s.substr(2),this.slashes=!0)}if(!ot[i]&&(T||i&&!st[i])){for(var h,E,O=-1,A=0;A<et.length;A++){-1!==(u=s.indexOf(et[A]))&&(-1===O||u<O)&&(O=u)}-1!==(E=-1===O?s.lastIndexOf("@"):s.lastIndexOf("@",O))&&(h=s.slice(0,E),s=s.slice(E+1),this.auth=decodeURIComponent(h)),O=-1;for(A=0;A<tt.length;A++){var u;-1!==(u=s.indexOf(tt[A]))&&(-1===O||u<O)&&(O=u)}-1===O&&(O=s.length),this.host=s.slice(0,O),s=s.slice(O),this.parseHost(),this.hostname=this.hostname||"";var G="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!G)for(var M=this.hostname.split(/\./),S=(A=0,M.length);A<S;A++){var c=M[A];if(c&&!c.match(_t)){for(var D="",l=0,f=c.length;l<f;l++)c.charCodeAt(l)>127?D+="x":D+=c[l];if(!D.match(_t)){var I=M.slice(0,A),p=M.slice(A+1),X=c.match(rt);X&&(I.push(X[1]),p.unshift(X[2])),p.length&&(s="/"+p.join(".")+s),this.hostname=I.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),G||(this.hostname=w.toASCII(this.hostname));var C=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+C,this.href+=this.host,G&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!nt[R])for(A=0,S=J.length;A<S;A++){var P=J[A];if(-1!==s.indexOf(P)){var B=encodeURIComponent(P);B===P&&(B=escape(P)),s=s.split(P).join(B)}}var v=s.indexOf("#");-1!==v&&(this.hash=s.substr(v),s=s.slice(0,v));var d=s.indexOf("?");if(-1!==d?(this.search=s.substr(d),this.query=s.substr(d+1),e&&(this.query=V.parse(this.query)),s=s.slice(0,d)):e&&(this.search="",this.query={}),s&&(this.pathname=s),st[R]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"";var N=this.search||"";this.path=C+N}return this.href=this.format(),this},K.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",_=this.pathname||"",r=this.hash||"",n=!1,o="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&b.isObject(this.query)&&Object.keys(this.query).length&&(o=V.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||st[e])&&!1!==n?(n="//"+(n||""),_&&"/"!==_.charAt(0)&&(_="/"+_)):n||(n=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),e+n+(_=_.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+r},K.prototype.resolve=function(t){return this.resolveObject(at(t,!1,!0)).format()},K.prototype.resolveObject=function(t){if(b.isString(t)){var e=new K;e.parse(t,!1,!0),t=e}for(var _=new K,r=Object.keys(this),n=0;n<r.length;n++){var o=r[n];_[o]=this[o]}if(_.hash=t.hash,""===t.href)return _.href=_.format(),_;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var i=s[a];"protocol"!==i&&(_[i]=t[i])}return st[_.protocol]&&_.hostname&&!_.pathname&&(_.path=_.pathname="/"),_.href=_.format(),_}if(t.protocol&&t.protocol!==_.protocol){if(!st[t.protocol]){for(var R=Object.keys(t),T=0;T<R.length;T++){var h=R[T];_[h]=t[h]}return _.href=_.format(),_}if(_.protocol=t.protocol,t.host||ot[t.protocol])_.pathname=t.pathname;else{for(var E=(t.pathname||"").split("/");E.length&&!(t.host=E.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==E[0]&&E.unshift(""),E.length<2&&E.unshift(""),_.pathname=E.join("/")}if(_.search=t.search,_.query=t.query,_.host=t.host||"",_.auth=t.auth,_.hostname=t.hostname||t.host,_.port=t.port,_.pathname||_.search){var O=_.pathname||"",A=_.search||"";_.path=O+A}return _.slashes=_.slashes||t.slashes,_.href=_.format(),_}var u=_.pathname&&"/"===_.pathname.charAt(0),G=t.host||t.pathname&&"/"===t.pathname.charAt(0),M=G||u||_.host&&t.pathname,S=M,c=_.pathname&&_.pathname.split("/")||[],D=(E=t.pathname&&t.pathname.split("/")||[],_.protocol&&!st[_.protocol]);if(D&&(_.hostname="",_.port=null,_.host&&(""===c[0]?c[0]=_.host:c.unshift(_.host)),_.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===E[0]?E[0]=t.host:E.unshift(t.host)),t.host=null),M=M&&(""===E[0]||""===c[0])),G)_.host=t.host||""===t.host?t.host:_.host,_.hostname=t.hostname||""===t.hostname?t.hostname:_.hostname,_.search=t.search,_.query=t.query,c=E;else if(E.length)c||(c=[]),c.pop(),c=c.concat(E),_.search=t.search,_.query=t.query;else if(!b.isNullOrUndefined(t.search)){if(D)_.hostname=_.host=c.shift(),(X=!!(_.host&&_.host.indexOf("@")>0)&&_.host.split("@"))&&(_.auth=X.shift(),_.host=_.hostname=X.shift());return _.search=t.search,_.query=t.query,b.isNull(_.pathname)&&b.isNull(_.search)||(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.href=_.format(),_}if(!c.length)return _.pathname=null,_.search?_.path="/"+_.search:_.path=null,_.href=_.format(),_;for(var l=c.slice(-1)[0],f=(_.host||t.host||c.length>1)&&("."===l||".."===l)||""===l,I=0,p=c.length;p>=0;p--)"."===(l=c[p])?c.splice(p,1):".."===l?(c.splice(p,1),I++):I&&(c.splice(p,1),I--);if(!M&&!S)for(;I--;I)c.unshift("..");!M||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),f&&"/"!==c.join("/").substr(-1)&&c.push("");var X,C=""===c[0]||c[0]&&"/"===c[0].charAt(0);D&&(_.hostname=_.host=C?"":c.length?c.shift():"",(X=!!(_.host&&_.host.indexOf("@")>0)&&_.host.split("@"))&&(_.auth=X.shift(),_.host=_.hostname=X.shift()));return(M=M||_.host&&c.length)&&!C&&c.unshift(""),c.length?_.pathname=c.join("/"):(_.pathname=null,_.path=null),b.isNull(_.pathname)&&b.isNull(_.search)||(_.path=(_.pathname?_.pathname:"")+(_.search?_.search:"")),_.auth=t.auth||_.auth,_.slashes=_.slashes||t.slashes,_.href=_.format(),_},K.prototype.parseHost=function(){var t=this.host,e=Q.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var it={parse:W,format:q,resolve:k};L.RETINA_PREFIX=/@([0-9\.]+)x/,L.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;(function(){for(var t=[],e=[],_=0;_<32;_++)t[_]=_,e[_]=_;t[o.NORMAL_NPM]=o.NORMAL,t[o.ADD_NPM]=o.ADD,t[o.SCREEN_NPM]=o.SCREEN,e[o.NORMAL]=o.NORMAL_NPM,e[o.ADD]=o.ADD_NPM,e[o.SCREEN]=o.SCREEN_NPM;var r=[];r.push(e),r.push(t)})(),function(){function t(t,e,_){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=_||L.RESOLUTION,this.resize(t,e)}t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0})}();var Rt,Tt,ht=function(){function t(){}return t.use=function(e,_){var r=e.data;if(e.type===n.TYPE.JSON&&r&&r.cacheID&&r.textures){for(var o=r.textures,s=void 0,a=void 0,i=0,R=o.length;i<R;i++){var T=o[i],h=T.src,E=T.format;if(E||(a=h),t.textureFormats[E]){s=h;break}}if(!(s=s||a))return void _(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(s===e.url)return void _(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var O={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},A=it.resolve(e.url.replace(this.baseUrl,""),s),u=r.cacheID;this.add(u,A,O,function(t){if(t.error)_(t.error);else{var r=t.texture,n=void 0===r?null:r,o=t.textures,s=void 0===o?{}:o;Object.assign(e,{texture:n,textures:s}),_()}})}else _()},t.add=function(){var e=document.createElement("canvas").getContext("webgl");if(e){var _={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};for(var r in t.textureExtensions=_,t.textureFormats={},_){var n=_[r];n&&Object.assign(t.textureFormats,Object.getPrototypeOf(n))}}},t}();function Et(t,e,n){var o={textures:{},texture:null};return e?(e.map(function(t){return new _(new r(t,Object.assign({mipmap:s.OFF,alphaMode:a.NO_PREMULTIPLIED_ALPHA},n)))}).forEach(function(e,n){var s=e.baseTexture,a=t+"-"+(n+1);r.addToCache(s,a),_.addToCache(e,a),0===n&&(r.addToCache(s,t),_.addToCache(e,t),o.texture=e),o.textures[a]=e}),o):o}n.setExtensionXhrType("dds",n.XHR_RESPONSE_TYPE.BUFFER);var Ot,At,ut=3,Gt=4,Mt=7,St=19,ct=2,Dt=0,lt=1,ft=2,It=3;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(Ot||(Ot={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(At||(At={}));var pt,Xt,Ct,Ft=((Rt={})[827611204]=h.COMPRESSED_RGBA_S3TC_DXT1_EXT,Rt[861165636]=h.COMPRESSED_RGBA_S3TC_DXT3_EXT,Rt[894720068]=h.COMPRESSED_RGBA_S3TC_DXT5_EXT,Rt),Pt=((Tt={})[Ot.DXGI_FORMAT_BC1_TYPELESS]=h.COMPRESSED_RGBA_S3TC_DXT1_EXT,Tt[Ot.DXGI_FORMAT_BC1_UNORM]=h.COMPRESSED_RGBA_S3TC_DXT1_EXT,Tt[Ot.DXGI_FORMAT_BC2_TYPELESS]=h.COMPRESSED_RGBA_S3TC_DXT3_EXT,Tt[Ot.DXGI_FORMAT_BC2_UNORM]=h.COMPRESSED_RGBA_S3TC_DXT3_EXT,Tt[Ot.DXGI_FORMAT_BC3_TYPELESS]=h.COMPRESSED_RGBA_S3TC_DXT5_EXT,Tt[Ot.DXGI_FORMAT_BC3_UNORM]=h.COMPRESSED_RGBA_S3TC_DXT5_EXT,Tt[Ot.DXGI_FORMAT_BC1_UNORM_SRGB]=h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Tt[Ot.DXGI_FORMAT_BC2_UNORM_SRGB]=h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Tt[Ot.DXGI_FORMAT_BC3_UNORM_SRGB]=h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Tt),Bt=function(){function t(){}return t.use=function(e,_){if("dds"===e.extension&&e.data)try{Object.assign(e,Et(e.name||e.url,t.parse(e.data),e.metadata))}catch(t){return void _(t)}_()},t.parse=function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var _=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),r=_[ut],n=_[Gt],o=_[Mt],s=new Uint32Array(t,St*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=s[1];if(4&a){var i=s[ct];if(808540228!==i){var R=Ft[i],T=new Uint8Array(t,128);return[new M(T,{format:R,width:n,height:r,levels:o})]}var h=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),O=h[Dt],A=h[lt],u=h[ft],G=h[It],S=Pt[O];if(void 0===S)throw new Error("DDSLoader cannot parse texture data with DXGI format "+O);if(4===u)throw new Error("DDSLoader does not support cubemap textures");if(A===At.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var c=new Array;if(1===G)c.push(new Uint8Array(t,148));else{for(var D=E[S],l=0,f=n,I=r,p=0;p<o;p++){l+=Math.max(1,f+3&-4)*Math.max(1,I+3&-4)*D,f>>>=1,I>>>=1}var X=148;for(p=0;p<G;p++)c.push(new Uint8Array(t,X,l)),X+=l}return c.map(function(t){return new M(t,{format:S,width:n,height:r,levels:o})})}if(64&a)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&a)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&a)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&a)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!")},t}();n.setExtensionXhrType("ktx",n.XHR_RESPONSE_TYPE.BUFFER);var vt=[171,75,84,88,32,49,49,187,13,10,26,10],dt=12,Nt=16,mt=24,Ut=28,Lt=36,gt=40,yt=44,wt=48,bt=52,xt=56,Yt=60,Ht=((pt={})[i.UNSIGNED_BYTE]=1,pt[i.UNSIGNED_SHORT]=2,pt[i.FLOAT]=4,pt[i.HALF_FLOAT]=8,pt),jt=((Xt={})[R.RGBA]=4,Xt[R.RGB]=3,Xt[R.LUMINANCE]=1,Xt[R.LUMINANCE_ALPHA]=2,Xt[R.ALPHA]=1,Xt),Vt=((Ct={})[i.UNSIGNED_SHORT_4_4_4_4]=2,Ct[i.UNSIGNED_SHORT_5_5_5_1]=2,Ct[i.UNSIGNED_SHORT_5_6_5]=2,Ct),Wt=function(){function t(){}return t.use=function(e,_){if("ktx"===e.extension&&e.data)try{var r=e.name||e.url;Object.assign(e,Et(r,t.parse(r,e.data),e.metadata))}catch(t){return void _(t)}_()},t.parse=function(e,_){var r=new DataView(_);if(!t.validate(e,r))return null;var n=67305985===r.getUint32(dt,!0),o=r.getUint32(Nt,n),s=r.getUint32(mt,n),a=r.getUint32(Ut,n),i=r.getUint32(Lt,n),R=r.getUint32(gt,n)||1,T=r.getUint32(yt,n)||1,h=r.getUint32(wt,n)||1,O=r.getUint32(bt,n),A=r.getUint32(xt,n),u=r.getUint32(Yt,n);if(0===R||1!==T)throw new Error("Only 2D textures are supported");if(1!==O)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==h)throw new Error("WebGL does not support array textures");var G,S=i+3&-4,c=R+3&-4,D=new Array(h),l=i*R;if(0===o&&(l=S*c),void 0===(G=0!==o?Ht[o]?Ht[o]*jt[s]:Vt[o]:E[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var f=l*G,I=i,p=R,X=S,C=c,F=64+u,P=0;P<A;P++){for(var B=r.getUint32(F,n),v=F+4,d=0;d<h;d++){var N=D[d];N||(N=D[d]=new Array(A)),N[P]={levelID:P,levelWidth:A>1?I:X,levelHeight:A>1?p:C,levelBuffer:new Uint8Array(_,v,f)},v+=f}F=(F+=B+4)%4!=0?F+4-F%4:F,f=(X=(I=I>>1||1)+4-1&-4)*(C=(p=p>>1||1)+4-1&-4)*G}if(0!==o)throw new Error("TODO: Uncompressed");return D.map(function(t){return new M(null,{format:a,width:i,height:R,levels:A,levelBuffers:t})})},t.validate=function(t,e){for(var _=0;_<vt.length;_++)if(e.getUint8(_)!==vt[_])return!1;return!0},t}();export{G as BlobResource,ht as CompressedTextureLoader,M as CompressedTextureResource,Bt as DDSLoader,jt as FORMATS_TO_COMPONENTS,h as INTERNAL_FORMATS,E as INTERNAL_FORMAT_TO_BYTES_PER_PIXEL,Wt as KTXLoader,Ht as TYPES_TO_BYTES_PER_COMPONENT,Vt as TYPES_TO_BYTES_PER_PIXEL};
//# sourceMappingURL=compressed-textures.min.js.map
